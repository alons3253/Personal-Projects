units           metal
dimension       3
boundary        p p p
atom_style      charge

#a = lattice constant


lattice custom 5.454 a1 1 0 0 a2 0 1 0 a3 0 0 1 &
basis 0.0 0.0 0.0 basis 0.5 0.5 0.0 basis 0.5 0.0 0.5 basis 0.0 0.5 0.5 &
basis 0.25 0.25 0.25 basis 0.75 0.25 0.25 basis 0.25 0.75 0.25 &
basis 0.75 0.75 0.25 basis 0.25 0.25 0.75 basis 0.75 0.25 0.75 basis 0.25 0.75 0.75 basis 0.75 0.75 0.75

region         box block 0 4 0 4 0 40
create_box     2 box

create_atoms   1 box  &
                 basis 1 1 &
		 basis 2 1 &
		 basis 3 1 &
		 basis 4 1 &
		 basis 5 2 &
                 basis 6 2 &
                 basis 7 2 &
                 basis 8 2 &
                 basis 9 2 &
                 basis 10 2 &
                 basis 11 2 &
                 basis 12 2     #Uranium  #Oxygen
		 
set type 1 charge 2.4
set type 2 charge -1.2

mass           1 238.0
mass           2 16.0

velocity       all create 300.0 87287

pair_style     hybrid/overlay buck/coul/long 10.000 morse 10.000
pair_coeff     1 1  buck/coul/long 294.776 0.32702  0
pair_coeff     1 2  buck/coul/long 693.951 0.327021 0
pair_coeff     2 2  buck/coul/long 1633.67 0.327022 3.95063
pair_coeff     1 1  morse 0       0    0
pair_coeff     1 2  morse 0.57745 1.65 2.369
pair_coeff     2 2  morse 0       0    0

kspace_style pppm 0.000001

neighbor        0.3 bin
neigh_modify    delay 0 every 1

timestep 0.001


# Heat Layers

region         hot block INF INF INF INF 0 2
region         cold block INF INF INF INF 20 22
compute        Thot all temp/region hot
compute        Tcold all temp/region cold


# 1st equilibration run

#dump 1 all xyz 1 structure.dat

fix            1 all nvt temp 300.0 300.0 0.2
thermo         100
run            10000

velocity       all scale 300.0

unfix          1


# 2nd equilibration run

fix            1 all nve
fix            hot all heat 1 2.0 region hot
fix            cold all heat 1 -2.0 region cold

thermo_style   custom step temp c_Thot c_Tcold
thermo         1000
run            300000


# Thermal Conductivity Calculation

compute        ke all ke/atom
variable       temp atom c_ke/1.5

compute        layers all chunk/atom bin/1d z lower 0.05 units reduced  
fix            2 all ave/chunk 10 100 1000 layers v_temp file profile_B3.heat

variable       tdiff equal f_2[11][3]-f_2[1][3]
fix            ave all ave/time 1 1 1000 v_tdiff ave running start 13000
thermo_style   custom step temp c_Thot c_Tcold v_tdiff f_ave

run            1000000
